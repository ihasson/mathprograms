Need to reorganize properly comment and put into one or two files.
